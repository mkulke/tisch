mixin panel(id, summary, description, color)
  li(class='panel', id=id)
    form
      div(class='header ' + color)
        input(type='text', name='summary', value=summary, class=color)
        .icons
          //img(class='open-button', src='/open.png', alt='open')
          a(href='#')
            img(class='save-button', src='/save.png', alt='save')
          a(href='#')
            img(class='remove-button', src='/remove.png', alt='remove')         
          a(href='#')
            img(class='show-button', src='/show.png', alt='show')
          a(href='#')
            img(class='hide-button', src='/hide.png', alt='hide')
        .handle
      .description
        textarea(name='description')
          =description

html
  head
    title Tasks
    include common
    script(type='text/javascript', src='/story.js')
    script(type='text/javascript')

      var items = {};
      items.task = !{JSON.stringify(tasks)};
      items.story = [!{JSON.stringify(story)}];

      $(document).ready(function() {

        attachAttributesToItems(items);
      });
  body
    #error-panel
      .message
      .icons
        a(href='#')
          img(class='ok-button', src='/ok.png', alt='ok')
    .main-panel(id='uuid-' + story._id)
      form
        div(class='header ' + story.color)
          input(type='text', name='title', value=story.title, class=story.color)
          .icons
            a(href='#')
              img(class='save-button', src='/save.png', alt='save')
          .handle
        .description
          textarea(name='description').
            #{story.description}
        hr
        .line
          mixin time-input(story, 'Time estimation', 'estimation')
        .line
          mixin color-selector('Color', story.color, 'color-selector')
    ul
      mixin panel('panel-template')
    ul(id='panel-container')

      each task, i in tasks
      
        mixin panel('uuid-' + task._id, task.summary, task.description, task.color)
    a(href='#')
      img(id='add-button', src='/add-circle.png', alt='add')
                