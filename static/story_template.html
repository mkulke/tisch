<div id="breadcrumb-bar">
  <a href="/" class="breadcrumb index">Index</a>
  <a href="/sprint/{{breadcrumbs.sprint.id}}" class="breadcrumb sprint">{{breadcrumbs.sprint.title}}</a>
  <a class="breadcrumb story selected">{{story.title}}</a>
</div>
<div id="content">
	<form>
		<p>
			<input id="title" class="identifier" on-keyup="trigger_update" on-keydown="set_before_value" on-focusout="execute_pending_update"  value="{{story.title}}"/>
		</p>
		<p>
			<textarea id="description" on-keyup="trigger_update" on-keydown="set_before_value" on-focusout="execute_pending_update" value="{{story.description}}"/>
		</p>
		<p class="attribute">
			<span class="label">{{constants.en_US.COLOR}}:&nbsp;</span>
			<span id="color-selector" class="popup-selector">
				<a href="#" class="open">
					<div on-tap="tapped_selector:color-selector" class="selected {{story.color}}"/>
					<div class="content">
					{{#COLORS:i}}
						<div on-tap='tapped_selector_item:{"selector_id":"color-selector","value":"{{.}}"}' class="color hoverable {{.}} box-{{i}}"/>
					{{/COLORS}}
					</div>
				</a>
			</span>
		</p>
		<p class="attribute">
			<span class="label">{{constants.en_US.SPRINT}}:&nbsp;</span>
			<span id="sprint-selector" class="popup-selector line-selector">
				<a href="#" class="open">
					<span on-tap="tapped_selector:sprint-selector" class="selected">{{sprint.title}}</span>
					<div class="content">
					{{#sprints}}
						<div on-tap='tapped_selector_item:{"selector_id":"sprint-selector","value":"{{_id}}"}' class="line">{{title}}</div>
					{{/sprints}}
					</div>
				</a>
			</span>
		</p>
		<p class="attribute">
			<span class="label">{{constants.en_US.ESTIMATION}}:&nbsp;</span>
			<input id="estimation" on-keyup="trigger_update" on-keydown="set_before_value" on-focusout="execute_pending_update" value="{{story.estimation}}"/>
			<span class="error-popup">
				<div class="content error">{{constants.en_US.VALID_TIME_MESSAGE}}</div>
			</span>
		</p>
		<!--<div class="stats">
		<table>
			<tr>
				<th>date</th>
				<th>all time_spent</th>
			</tr>
			{{#buildTSMatrix(children, buildSprintRange(sprint))}}
				<tr>
					<td>{{date}}</td>
					<td>{{time_spent}}</td>
				</tr>
			{{/buildTSMatrix}}
		</table>
		<table>
			<tr>
				<th>date</th>
				<th>all remaining_time</th>
			</tr>
			{{#buildRTMatrix(children, buildSprintRange(sprint))}}
				<tr>
					<td>{{date}}</td>
					<td>{{remaining_time}}</td>
				</tr>
			{{/buildRTMatrix}}
		</table>
		</div>-->
		<ul id="well">
			{{#children:i}}
				<li class="panel">
					<div class="header {{color}} hoverable">
						<input id="summary-{{i}}" on-keyup="trigger_update" on-keydown="set_before_value" on-focusout="execute_pending_update" value="{{summary}}"/>
						<div class="stats">
							<img src="/{{buildRemainingTime(remaining_time, buildSprintRange(sprint)) > 0 ? 'clock_white_30.png' : 'done_white_30.png'}}">
							<div class="text">{{buildRemainingTime(remaining_time, buildSprintRange(sprint)) > 0 ? buildRemainingTime(remaining_time, buildSprintRange(sprint)) : ''}}</div>
						</div>
					</div>
					<textarea id="description-{{i}}" class="body" on-keyup="trigger_update" on-keydown="set_before_value"  on-focusout="execute_pending_update" c value="{{description}}"/>
					<div class="button-bar">
						<div class="buttons">
							<input on-tap="tapped_button:task_open" class="button open" type="button" value="{{constants.en_US.OPEN}}">
							<input on-tap="tapped_button:task_remove" class="button remove" type="button" value="{{constants.en_US.REMOVE}}">
						</div>
					</div>
				</li>
			{{/children}}
		</ul>
	</form>
</div>
<div id="button-bar">
	<form class="buttons">
		<input on-tap="tapped_button:show_stats" class="button stats" type="button" value="{{constants.en_US.SHOW_STATS}}">
		<input on-tap="tapped_button:task_add" class="button add" type="button" value="{{constants.en_US.ADD_TASK}}">
		<input on-tap="tapped_button:story_remove" class="button remove" type="button" value="{{constants.en_US.REMOVE}}">
	</form>
</div>
<div class="modal" id="error-dialog">
	<div class="message error">{{error_message}}</div>
	<div class="popup-buttons">
		<form class="buttons">
			<input on-tap="tapped_button:error_ok" class="button" type="button" value="{{constants.en_US.OK}}">
		</form>
	</div>
</div>
<div class="modal" id="confirm-dialog">
	<div class="message warning">{{confirm_message}}</div>
	<div class="popup-buttons">
		<form class="buttons">
			<input on-tap="tapped_button:confirm_cancel" class="button" type="button" value="{{constants.en_US.CANCEL}}">
			<input on-tap="tapped_button:confirm_confirm" class="button" type="button" value="{{constants.en_US.CONFIRM}}">
		</form>
	</div>
</div>
<div class="modal" id="stats-dialog">
	<div class="content">
		<div class="textbox">
			<p class="stat">
				<span class="label">No. of Tasks:&nbsp;</span>
				<span class="value">{{countTasks(children)}}</span>
			</p>
			<p class="stat remainingTime">
				<span class="indicator blue"></span>
				<span class="label">Remaining time:&nbsp;</span>
				<span class="value">{{calculateRemainingTime(children, buildSprintRange(sprint), buildRemainingTime)}}</span>
			</p>
			<p class="stat timeSpent">
				<span class="indicator red"></span>
				<span class="label">Time spent:&nbsp;</span>
				<span class="value">{{buildAllTimeSpent(children, buildSprintRange(sprint), buildTimeSpent)}}</span>
			</p>
		</div><div class="chartbox"><div id="chart"></div></div>
	</div>
	<div class="popup-buttons">
		<form class="buttons">
			<input on-tap="tapped_button:stats_close" class="button" type="button" value="{{constants.en_US.CLOSE}}">
		</form>
	</div>
</div>