html
	head
		title Sprint details
		include shared_ractive
		script(type='text/javascript', src='/sprint.coffee.js')
	body(data-bind="event: {keyup: cancelPopup}")
		#container
			#breadcrumb-bar
				a(href="/").breadcrumb.index Index
				span(data-bind="text: title").breadcrumb.sprint.selected
			#content
				form
					p
						input(data-bind="value: title, valueUpdate: ['afterkeydown','propertychange','input']", name="title")#title.identifier
					p
						textarea(data-bind="value: description, valueUpdate: ['afterkeydown','propertychange','input']", name="description")#description
					.attribute
						span.label
							=messages.en.COLOR+':'
						span#color-selector.popup-selector
							button(data-bind="click: showColorSelector, css: color", name="color")
								span(data-bind="css: color").selected
							div(data-bind="foreach: common.COLORS, visible: modal() == 'color-selector'").content
								div(data-bind="click: $parent.selectColor, css: $data + ' box-' + $index()").color.hoverable
					.attribute
						span.label
							=messages.en.START_DATE+':'
						span#start.popup-selector.date-selector
							button(data-bind="click: showStartDatePicker, text: startFormatted()", name="start").selected
							div(data-bind="datepicker: start, visible: modal() == 'start-selector'").content
			#button-bar
				form.buttons
					input(type='button', value=messages.en.ADD_STORY).button.add
		div(data-bind="visible: modal() != null")#overlay
		script(type='text/javascript')

			var model, viewModel;
			model = new SprintModel(!{JSON.stringify(stories)}, !{JSON.stringify(sprint)}, !{JSON.stringify(calculations)});
			viewModel = new SprintViewModel(model);
			ko.applyBindings(viewModel);